{"variants":[{"traits":[{"interfaceLanguage":"swift"}],"paths":["\/documentation\/env\/scopedconfiguration"]}],"hierarchy":{"paths":[["doc:\/\/Env\/documentation\/Env"]]},"primaryContentSections":[{"kind":"content","content":[{"level":2,"type":"heading","text":"概要","anchor":"%E6%A6%82%E8%A6%81"},{"type":"paragraph","inlineContent":[{"type":"text","text":"関連する設定をグループ化する場合、"},{"code":"@Env(scope:)","type":"codeVoice"},{"type":"text","text":" を使用して"},{"type":"text","text":" "},{"type":"text","text":"キープレフィックスを指定できます。"}]},{"level":2,"type":"heading","text":"スコープの使い方","anchor":"%E3%82%B9%E3%82%B3%E3%83%BC%E3%83%97%E3%81%AE%E4%BD%BF%E3%81%84%E6%96%B9"},{"level":3,"type":"heading","text":"スコープ付き設定の定義","anchor":"%E3%82%B9%E3%82%B3%E3%83%BC%E3%83%97%E4%BB%98%E3%81%8D%E8%A8%AD%E5%AE%9A%E3%81%AE%E5%AE%9A%E7%BE%A9"},{"syntax":"swift","code":["import Env","","@Env(scope: \"emulator\")","struct EmulatorConfig {","    @Value(\"firestore.host\", default: \"localhost\")","    var firestoreHost: String","","    @Value(\"firestore.port\", default: 8090)","    var firestorePort: Int","","    @Value(\"auth.host\", default: \"localhost\")","    var authHost: String","","    @Value(\"auth.port\", default: 9099)","    var authPort: Int","}"],"type":"codeListing"},{"level":3,"type":"heading","text":"環境変数との対応","anchor":"%E7%92%B0%E5%A2%83%E5%A4%89%E6%95%B0%E3%81%A8%E3%81%AE%E5%AF%BE%E5%BF%9C"},{"type":"paragraph","inlineContent":[{"code":"scope: \"emulator\"","type":"codeVoice"},{"type":"text","text":" を指定すると、以下のように環境変数名が生成されます："}]},{"type":"table","header":"row","rows":[[[{"inlineContent":[{"text":"キー","type":"text"}],"type":"paragraph"}],[{"inlineContent":[{"type":"text","text":"環境変数名"}],"type":"paragraph"}]],[[{"inlineContent":[{"code":"firestore.host","type":"codeVoice"}],"type":"paragraph"}],[{"inlineContent":[{"type":"codeVoice","code":"EMULATOR_FIRESTORE_HOST"}],"type":"paragraph"}]],[[{"inlineContent":[{"type":"codeVoice","code":"firestore.port"}],"type":"paragraph"}],[{"inlineContent":[{"type":"codeVoice","code":"EMULATOR_FIRESTORE_PORT"}],"type":"paragraph"}]],[[{"inlineContent":[{"type":"codeVoice","code":"auth.host"}],"type":"paragraph"}],[{"inlineContent":[{"code":"EMULATOR_AUTH_HOST","type":"codeVoice"}],"type":"paragraph"}]],[[{"inlineContent":[{"type":"codeVoice","code":"auth.port"}],"type":"paragraph"}],[{"inlineContent":[{"type":"codeVoice","code":"EMULATOR_AUTH_PORT"}],"type":"paragraph"}]]]},{"level":3,"type":"heading","text":"使用方法","anchor":"%E4%BD%BF%E7%94%A8%E6%96%B9%E6%B3%95"},{"syntax":"swift","code":["let config = ConfigReader(provider: EnvironmentVariablesProvider())","","\/\/ root config を渡す（スコープは内部で処理される）","let emulator = EmulatorConfig(config: config)","","print(\"Firestore: \\(emulator.firestoreHost):\\(emulator.firestorePort)\")","print(\"Auth: \\(emulator.authHost):\\(emulator.authPort)\")"],"type":"codeListing"},{"level":2,"type":"heading","text":"展開されるコード","anchor":"%E5%B1%95%E9%96%8B%E3%81%95%E3%82%8C%E3%82%8B%E3%82%B3%E3%83%BC%E3%83%89"},{"type":"paragraph","inlineContent":[{"code":"@Env(scope: \"emulator\")","type":"codeVoice"},{"text":" は以下のようなコードを生成します：","type":"text"}]},{"syntax":"swift","code":["struct EmulatorConfig {","    var firestoreHost: String","    var firestorePort: Int","    var authHost: String","    var authPort: Int","","    private enum Keys {","        static let firestoreHost: ConfigKey = \"firestore.host\"","        static let firestorePort: ConfigKey = \"firestore.port\"","        static let authHost: ConfigKey = \"auth.host\"","        static let authPort: ConfigKey = \"auth.port\"","    }","","    private enum Defaults {","        static let firestoreHost = \"localhost\"","        static let firestorePort = 8090","        static let authHost = \"localhost\"","        static let authPort = 9099","    }","","    public init(config: ConfigReader) {","        let scopedConfig = config.scoped(to: \"emulator\")","        self.firestoreHost = scopedConfig.string(forKey: Keys.firestoreHost, default: Defaults.firestoreHost)","        self.firestorePort = scopedConfig.int(forKey: Keys.firestorePort, default: Defaults.firestorePort)","        self.authHost = scopedConfig.string(forKey: Keys.authHost, default: Defaults.authHost)","        self.authPort = scopedConfig.int(forKey: Keys.authPort, default: Defaults.authPort)","    }","}","","extension EmulatorConfig: Sendable {}"],"type":"codeListing"},{"level":2,"type":"heading","text":"複数設定の組み合わせ","anchor":"%E8%A4%87%E6%95%B0%E8%A8%AD%E5%AE%9A%E3%81%AE%E7%B5%84%E3%81%BF%E5%90%88%E3%82%8F%E3%81%9B"},{"syntax":"swift","code":["@Env","struct GCPConfig {","    @Value(\"gcp.project.id\", default: \"stockle-app\")","    var projectId: String","","    @Value(\"firebase.emulator\", default: false)","    var useEmulator: Bool","}","","@Env(scope: \"emulator\")","struct EmulatorConfig {","    @Value(\"firestore.host\", default: \"localhost\")","    var firestoreHost: String","","    @Value(\"firestore.port\", default: 8090)","    var firestorePort: Int","}","","\/\/ 使用例","let config = ConfigReader(provider: EnvironmentVariablesProvider())","let gcp = GCPConfig(config: config)","let emulator = EmulatorConfig(config: config)","","if gcp.useEmulator {","    print(\"Emulator: \\(emulator.firestoreHost):\\(emulator.firestorePort)\")","} else {","    print(\"Production: \\(gcp.projectId)\")","}"],"type":"codeListing"}]}],"kind":"article","metadata":{"title":"スコープ付き設定","roleHeading":"Article","modules":[{"name":"Env"}],"role":"article"},"sections":[],"identifier":{"interfaceLanguage":"swift","url":"doc:\/\/Env\/documentation\/Env\/ScopedConfiguration"},"seeAlsoSections":[{"title":"使用例","identifiers":["doc:\/\/Env\/documentation\/Env\/GettingStarted"],"generated":true,"anchor":"使用例"}],"schemaVersion":{"minor":3,"major":0,"patch":0},"abstract":[{"type":"text","text":"キープレフィックスを持つ設定グループの定義方法を学びます。"}],"references":{"doc://Env/documentation/Env":{"abstract":[{"type":"text","text":"Swiftマクロによる環境変数設定の宣言的アクセス。"}],"kind":"symbol","type":"topic","url":"\/documentation\/env","identifier":"doc:\/\/Env\/documentation\/Env","role":"collection","title":"Env"},"doc://Env/documentation/Env/GettingStarted":{"role":"article","kind":"article","type":"topic","identifier":"doc:\/\/Env\/documentation\/Env\/GettingStarted","url":"\/documentation\/env\/gettingstarted","title":"はじめに","abstract":[{"text":"環境変数設定を宣言的に定義する方法を学びます。","type":"text"}]}}}